<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style2.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <title>Dashboard page</title>
</head>
<body>

    <div id="logout">
    <a href="/logout" class="logout">Logout</a>
    </div>
 
    <div class="title">
        <h1>Welcome, <%= username %></h1>
    </div>
<div class="section">
    <div class="container">
    <h2>What's On Your Mind?</h2>
            <div class="img-upload">
            <i class="bx bxs-cloud-upload icon"></i>
            <h3>Upload Image</h3>
            <p>Accepted file types are .jpg, .png, .gif, not exceeding 2MB in file size</p>
            <form action="/upload" method="POST"
                enctype="multipart/form-data">
                <input type="file" name="picture">
                <input type="submit"> 
            </form>
            </div>
            <ul> 
                <% if(messages.error) { %>
                <li>  <%= messages.error %> </li>
                    <% } %>
          </ul>
        </div>
    </div>

         <% values.forEach( x => { %>
            <section>
                <div class="box">
                    <div class="name">
                        <h4><%= x.name %></h4>
                    </div>

                    <div class="timestamp"><h4><%= x.timeStamp.toDateString() %></h4>
                    </div>
                    <div class="img">
                        <img width="700" height="700" src="data:<%= x.data %>;base64,<%= x.img %>" />
                    </div>
                    <!-- <div class="like">
                        <form action="/like" method="POST">
                           <input name="like" id="like" type="hidden"><i onclick="toggleUp(this)" class="fa fa-thumbs-up"></i> </input>
                            <span id="increment"><%= x.likes %></span> 
                            <input type="hidden" id="photoid" name="photoid" value="<%= x.photoid %>" />  
                        </form>
                    
                    </div> -->

                    <div class="like">
                        <form action="/like" method="POST">
                        <input type="hidden" id="photoid" name="photoid" value="<%= x.photoid %>" /> 
                        <input type="hidden" name="like" id="like" value=" <%= x.isLiked %> "/>   
                        <button type="submit" name="like" value="like"> 
                        <% if(x.isLiked) { %>
                            <!--unlike-->
                                <i onclick="toggleUp(this)" class="fa fa-thumbs-down"> </i>  
                            <% } else { %>
                            <!--like-->
                                <i onclick="toggleDown(this)" class="fa fa-thumbs-up"></i>   
                                <!-- <input type="hidden" name="like" id="like" value=" <%= x.isLiked %> "/>   
                                <input type="hidden" id="photoid" name="photoid" value="<%= x.photoid %>" />   -->
                                <% } %>
                            </button> <%= x.likes %> 
                            </form>
                           
                    </div>
                    
                    <div class="section2">
                            <h5><%= user %></h5> 
                        <form action="/comment" method="POST">
                            <input type="text" id="comment" name="comment" placeholder="Leave a comment here">
                            <input type="submit" value="Comment"/>
                            <input type="hidden" id="photoid" name="photoid" value="<%= x.photoid %>" />  
                        </form>
                    </div>
                     <div class="imgComment">
                            <% x.comment.forEach( y => { %>
                            <p><span id="name"><u><b><%= y.fullname %></b></u></span> <span id="comment"><%= y.commentStr %></span> <span id="time"><%= y.createdTime.toDateString() %></span></p>
                            <% }) %>
                        </div>
                    </div> 
                </div>
                </div>
            </section>
        <% }) %>

        <script>
            function toggleUp(x) {
                x.classList.toggle("fa-thumbs-up");
            }

            function toggleDown(x) {
                x.classList.toggle("fa-thumbs-down");
            }
        </script>      
</body>
</html>
